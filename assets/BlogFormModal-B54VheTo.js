import{r as c,j as e,m as S,e as w}from"./index-Nnme1ILz.js";import{u as P,I as n}from"./Input-DaiDae5B.js";import{u as E,c as B}from"./blogService-BXpqFAI3.js";import{u as C}from"./uploadService-CZVGdzxx.js";import{T as x}from"./Textarea-tXh7MUqa.js";import{B as b}from"./Button-DcKssBXq.js";import{B as T}from"./constants-DAdbbRzX.js";import{A as k}from"./index-B5J0J5mJ.js";const V=({post:o,onClose:l})=>{const[d,u]=c.useState(!1),[p,g]=c.useState(!1),[f,m]=c.useState(""),{register:t,handleSubmit:j,formState:{errors:i},setValue:y,watch:v}=P({defaultValues:o||{title:"",excerpt:"",content:"",featuredImage:"",category:"Tech",tags:"",published:!0}}),h=v("featuredImage");c.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const I=async a=>{const r=a.target.files[0];if(r)try{g(!0);const s=await C(r);y("featuredImage",s.url)}catch{alert("Failed to upload image")}finally{g(!1)}},N=async a=>{try{if(u(!0),m(""),!a.featuredImage){m("Please upload or provide a featured image");return}const r={...a,tags:a.tags.split(",").map(s=>s.trim()).filter(s=>s)};o?await E(o._id,r):await B(r),l()}catch(r){m(r.response?.data?.message||"Failed to save post")}finally{u(!1)}};return e.jsx(k,{children:e.jsx("div",{className:"modal-overlay",onClick:l,children:e.jsxs(S.div,{className:"blog-form-modal",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:o?"Edit Blog Post":"Create New Post"}),e.jsx("button",{onClick:l,className:"modal-close-btn",children:e.jsx(w,{size:20})})]}),e.jsxs("form",{onSubmit:j(N),className:"blog-form",children:[e.jsx(n,{label:"Title",name:"title",placeholder:"Getting Started with React Hooks",register:t,error:i.title,required:!0}),e.jsx(x,{label:"Excerpt",name:"excerpt",placeholder:"Short summary of your post...",rows:2,register:t,error:i.excerpt,required:!0}),e.jsx(x,{label:"Content",name:"content",placeholder:"Write your blog post content here...",rows:8,register:t,error:i.content,required:!0}),e.jsx(n,{label:"Tags (comma-separated)",name:"tags",placeholder:"React, JavaScript, Tutorial",register:t}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:I,disabled:p}),p&&e.jsx("p",{className:"uploading",children:"Uploading..."}),h&&e.jsx("img",{src:h,alt:"Preview",className:"image-preview"})]}),e.jsx(n,{label:"Featured Image URL (or upload above)",name:"featuredImage",placeholder:"https://...",register:t,error:i.featuredImage}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("select",{...t("category"),className:"form-select",children:T.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",...t("published")}),e.jsx("span",{children:"Publish immediately"})]})}),f&&e.jsx("p",{className:"error-text",children:f}),e.jsxs("div",{className:"form-actions",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(b,{type:"submit",variant:"primary",disabled:d,children:d?"Saving...":o?"Update Post":"Create Post"})]})]})]})})})};export{V as default};
