import{r as n,j as e,m as N,e as P}from"./index-Nnme1ILz.js";import{u as k,I as s}from"./Input-DaiDae5B.js";import{u as U,c as w}from"./projectService-DBviqL38.js";import{u as E}from"./uploadService-CZVGdzxx.js";import{T as C}from"./Textarea-tXh7MUqa.js";import{B as j}from"./Button-DcKssBXq.js";import{P as I}from"./constants-DAdbbRzX.js";import{A as T}from"./index-B5J0J5mJ.js";const M=({project:i,onClose:c})=>{const[d,u]=n.useState(!1),[p,h]=n.useState(!1),[f,m]=n.useState(""),{register:t,handleSubmit:x,formState:{errors:o},setValue:g,watch:y}=k({defaultValues:i||{title:"",description:"",fullDescription:"",thumbnail:"",techStack:"",category:"Web App",liveUrl:"",githubUrl:"",featured:!1}}),b=y("thumbnail");n.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const v=async a=>{const r=a.target.files[0];if(r)try{h(!0);const l=await E(r);g("thumbnail",l.url)}catch{alert("Failed to upload image")}finally{h(!1)}},S=async a=>{try{if(u(!0),m(""),!a.thumbnail){m("Please upload or provide a thumbnail image");return}const r={...a,techStack:a.techStack.split(",").map(l=>l.trim()).filter(l=>l)};i?await U(i._id,r):await w(r),c()}catch(r){m(r.response?.data?.message||"Failed to save project")}finally{u(!1)}};return e.jsx(T,{children:e.jsx("div",{className:"modal-overlay",onClick:c,children:e.jsxs(N.div,{className:"project-form-modal",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:i?"Edit Project":"Create New Project"}),e.jsx("button",{onClick:c,className:"modal-close-btn",children:e.jsx(P,{size:20})})]}),e.jsxs("form",{onSubmit:x(S),className:"project-form",children:[e.jsx(s,{label:"Title",name:"title",placeholder:"E-Commerce Platform",register:t,error:o.title,required:!0}),e.jsx(s,{label:"Short Description",name:"description",placeholder:"Full-stack online shopping platform",register:t,error:o.description,required:!0}),e.jsx(C,{label:"Full Description",name:"fullDescription",placeholder:"Detailed description of your project...",rows:4,register:t,error:o.fullDescription,required:!0}),e.jsx(s,{label:"Tech Stack (comma-separated)",name:"techStack",placeholder:"React, Node.js, MongoDB, Stripe",register:t,error:o.techStack,required:!0}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Thumbnail Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:v,disabled:p}),p&&e.jsx("p",{className:"uploading",children:"Uploading..."}),b&&e.jsx("img",{src:b,alt:"Preview",className:"image-preview"})]}),e.jsx(s,{label:"Thumbnail URL (or upload above)",name:"thumbnail",placeholder:"https://...",register:t,error:o.thumbnail}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("select",{...t("category"),className:"form-select",children:I.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx(s,{label:"Live URL",name:"liveUrl",placeholder:"https://...",register:t}),e.jsx(s,{label:"GitHub URL",name:"githubUrl",placeholder:"https://github.com/...",register:t}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",...t("featured")}),e.jsx("span",{children:"Featured Project"})]})}),f&&e.jsx("p",{className:"error-text",children:f}),e.jsxs("div",{className:"form-actions",children:[e.jsx(j,{type:"button",variant:"secondary",onClick:c,children:"Cancel"}),e.jsx(j,{type:"submit",variant:"primary",disabled:d,children:d?"Saving...":i?"Update Project":"Create Project"})]})]})]})})})};export{M as default};
